<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Tree Builder - Project Requirements</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c5f2d;
            border-bottom: 3px solid #2c5f2d;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #2c5f2d;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        h3 {
            color: #444;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .intro {
            background: #e8f5e9;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
            border-left: 4px solid #2c5f2d;
        }
        
        .goal {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .deliverables {
            background: #fff3cd;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #ffc107;
        }
        
        ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .constraint {
            background: #f8d7da;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #dc3545;
            margin-top: 15px;
        }
        
        .feature {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #2196f3;
            margin-top: 15px;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .code-block {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #ddd;
        }
        
        .code-block pre {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
        }
        
        strong {
            color: #2c5f2d;
        }
        
        .highlight {
            background: #fff9c4;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Family Tree Builder - Project Requirements</h1>
        
        <div class="intro">
            <p><strong>You are a senior frontend engineer and UX designer.</strong></p>
        </div>
        
        <div class="section">
            <h2>Goal</h2>
            <p class="goal">Build a SIMPLE, offline-first "Family Tree Builder" web app that I can run by double-clicking index.html (no backend, no login, no database, no build tools). It must be easy for a non-expert to use to DRAW and maintain my family tree.</p>
        </div>
        
        <div class="section">
            <h2>Deliverables</h2>
            <div class="deliverables">
                <p>Create a small project with these files:</p>
                <ul>
                    <li><code>index.html</code></li>
                    <li><code>styles.css</code></li>
                    <li><code>app.js</code></li>
                    <li><code>README.md</code></li>
                </ul>
            </div>
        </div>
        
        <div class="section">
            <h2>Hard Constraints</h2>
            <div class="constraint">
                <ul>
                    <li>No frameworks required (plain HTML/CSS/JS)</li>
                    <li>No npm, no Next.js, no server needed</li>
                    <li>Data must persist locally using localStorage</li>
                    <li>Provide Export / Import as a JSON file so I can back up and move to another device</li>
                    <li>Must work on modern Chrome/Edge</li>
                    <li>Keep UI clean, minimal, and mobile-friendly</li>
                </ul>
            </div>
        </div>
        
        <div class="section">
            <h2>Core Features (Must Implement)</h2>
            
            <div class="feature">
                <h3>1) People (nodes)</h3>
                <ul>
                    <li>Add person with: Full Name (required), Gender (optional), Birth year (optional), Death year (optional), Notes (optional)</li>
                    <li>Edit person</li>
                    <li>Delete person (with confirmation)</li>
                    <li>Optional: a small "branch/tag" field (e.g., "Al-____")</li>
                    <li>Each person has a unique id generated in JS</li>
                </ul>
            </div>
            
            <div class="feature">
                <h3>2) Relationships (edges)</h3>
                <ul>
                    <li>Parent → Child link</li>
                    <li>Spouse link</li>
                    <li>UI must let me:
                        <ul>
                            <li>Select a person, click "Add Parent", "Add Child", "Add Spouse"</li>
                            <li>Or "Link Existing Person" (choose from list) to avoid duplicates</li>
                        </ul>
                    </li>
                    <li>Prevent impossible links (e.g., parent=child, duplicate edges)</li>
                </ul>
            </div>
            
            <div class="feature">
                <h3>3) Tree drawing</h3>
                <ul>
                    <li>Render the tree visually using SVG (preferred) or Canvas</li>
                    <li>Provide pan + zoom (mouse wheel; touch-friendly if possible)</li>
                    <li>Provide a simple auto-layout:
                        <ul>
                            <li>Generations stacked vertically (ancestors above, descendants below)</li>
                            <li>Siblings aligned horizontally</li>
                            <li>Spouses side-by-side</li>
                        </ul>
                    </li>
                    <li>Nodes should be draggable to manually adjust positions (store positions)</li>
                    <li>Clicking a node opens a right-side drawer with details + actions</li>
                </ul>
            </div>
            
            <div class="feature">
                <h3>4) Search & navigation</h3>
                <ul>
                    <li>Search box that filters and highlights matching names</li>
                    <li>Search must match:
                        <ul>
                            <li>name</li>
                            <li>tag</li>
                            <li>originCountry/originCity/originArea/originFamilyBranch</li>
                        </ul>
                    </li>
                    <li>"Focus" button: centers the view on a selected person</li>
                    <li>"Home" button: fits the full tree to screen</li>
                </ul>
            </div>
            
            <div class="feature">
                <h3>5) Safety / backup / printing</h3>
                <ul>
                    <li>Export JSON (download file)</li>
                    <li>Import JSON (upload file)</li>
                    <li>"Reset data" button with strong confirmation</li>
                    <li>"Print / Save as PDF" view: a clean layout for printing (basic is fine)</li>
                </ul>
            </div>
        </div>
        
        <div class="section">
            <h2>UX Requirements</h2>
            <ul>
                <li>Top bar with: Add Person, Search, Country Filter, City Filter, Export, Import, Print, Reset, Settings</li>
                <li>Right panel (drawer) with: person info + quick relationship buttons + origin/roots section</li>
                <li>Helpful empty state ("No people yet—click Add Person")</li>
                <li>Clear error messages and validation</li>
                <li>Mobile-friendly layout</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>Origin / Roots Feature (Must Implement)</h2>
            
            <h3>1) Data model updates (backward compatible)</h3>
            <p>Extend each person with:</p>
            <div class="code-block">
                <pre>- originCountry (string, optional)      // e.g., Bahrain, Saudi Arabia
- originCity (string, optional)         // e.g., Manama, A'ali, Sitra
- originArea (string, optional)         // e.g., village/neighborhood: 'Aker, Jableh, etc.
- originFamilyBranch (string, optional) // e.g., branch/tribe/family label
- originNotes (string, optional)</pre>
            </div>
            <p><span class="highlight">Older saved data without these fields must NOT break the app</span>; missing fields should default to "".</p>
            
            <h3>2) UI updates (simple + fast)</h3>
            <ul>
                <li>In the Person Drawer, add an "Origin / Roots" section with inputs:
                    <ul>
                        <li>Country (text + datalist suggestions derived from existing people + common countries)</li>
                        <li>City (text + datalist suggestions derived from existing people)</li>
                        <li>Area/Neighborhood (text)</li>
                        <li>Family Branch/Label (text)</li>
                        <li>Notes (textarea)</li>
                    </ul>
                </li>
                <li>On each node card, show a small badge under the name:
                    <ul>
                        <li>Prefer: originCity OR originCountry (whichever exists)</li>
                        <li>If neither exists, show nothing</li>
                    </ul>
                </li>
                <li>Add a settings toggle: "Hide origin badges" stored in localStorage and applied immediately</li>
            </ul>
            
            <h3>3) Filters</h3>
            <ul>
                <li>Add filter dropdowns:
                    <ul>
                        <li>Filter by Country: All + unique countries derived from people data</li>
                        <li>Filter by City: All + unique cities derived from people data (optionally dependent on selected country)</li>
                    </ul>
                </li>
                <li>Filters must affect:
                    <ul>
                        <li>Nodes visibility (and related edges visibility)</li>
                        <li>Directory/list results if you have a people directory view</li>
                    </ul>
                </li>
                <li>The tree view should still function with filters on (focus, pan/zoom)</li>
            </ul>
            
            <h3>4) Copy origin helper (nice-to-have but implement)</h3>
            <ul>
                <li>Provide a "Copy origin from…" button/dropdown in the drawer:
                    <ul>
                        <li>Choose an existing person and copy all origin fields to the currently selected person</li>
                    </ul>
                </li>
            </ul>
        </div>
        
        <div class="section">
            <h2>Implementation Details</h2>
            <p>Use a single data model in app.js like:</p>
            <div class="code-block">
                <pre>state = {
  dataVersion: 2,
  ui: { 
    hideOriginBadges: false, 
    filterCountry: "All", 
    filterCity: "All" 
  },
  people: [{ 
    id, name, gender, birthYear, deathYear, notes, tag, x, y,
    originCountry, originCity, originArea, 
    originFamilyBranch, originNotes 
  }],
  relations: [{ 
    id, 
    type: "PARENT_CHILD"|"SPOUSE", 
    aId, bId 
  }]
}</pre>
            </div>
            <ul>
                <li>Store to localStorage on every change (debounced)</li>
                <li>Provide migration logic:
                    <ul>
                        <li>If saved dataVersion missing or < 2, add missing fields and set dataVersion = 2</li>
                    </ul>
                </li>
                <li>Provide a small sample dataset function (3 generations) for demo, with mixed origins/cities</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>Export/Import Requirements</h2>
            <ul>
                <li>Export JSON must include all fields (including origin + ui settings + dataVersion)</li>
                <li>Import JSON must validate minimally and safely:
                    <ul>
                        <li>If origin fields missing, set to ""</li>
                        <li>If ui settings missing, set defaults</li>
                        <li>Never crash on unknown extra fields (ignore unknown keys)</li>
                        <li>Validate that people ids are unique and relations refer to existing people; if not, skip invalid relations with a warning</li>
                    </ul>
                </li>
            </ul>
        </div>
        
        <div class="section">
            <h2>README Must Include</h2>
            <ul>
                <li>How to run (double-click index.html)</li>
                <li>How to export/import</li>
                <li>Tips for building the tree</li>
                <li>Origin/Roots fields + filtering instructions</li>
                <li>Known limitations</li>
                <li>"Next step" section: how we can later upgrade to Next.js + database + accounts</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>Final Deliverable</h2>
            <p>Now output:</p>
            <ol>
                <li>File tree</li>
                <li>Full code for each file (index.html, styles.css, app.js, README.md)</li>
                <li>Final checklist to verify it works</li>
            </ol>
        </div>
    </div>
</body>
</html>
